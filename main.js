/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ABSPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  host: "",
  library: "",
  token: "",
  folder: "",
  template: ""
};
var ABSPlugin = class extends import_obsidian.Plugin {
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new ABSPluginSettingTab(this.app, this));
    const ribbonIconEl = this.addRibbonIcon("audio-file", "ABS", () => {
      new import_obsidian.Notice("Fetching audiobooks...");
      this.fetchAndCreateNotes();
    });
    this.addCommand({
      id: "fetch-books",
      name: "Fetch books and create notes",
      callback: async () => {
        await this.fetchAndCreateNotes();
      }
    });
  }
  async fetchAndCreateNotes() {
    if (!this.settings.host || !this.settings.library || !this.settings.token) {
      new import_obsidian.Notice("Please configure API settings in the ABS Plugin settings.");
      return;
    }
    if (!this.settings.folder) {
      new import_obsidian.Notice("Please configure destination folder in the ABS Plugin settings.");
      return;
    }
    const apiUrl = `https://${this.settings.host}/api/libraries/${this.settings.library}/items?sort=media.metadata.title`;
    try {
      const response = await (0, import_obsidian.request)({
        url: apiUrl,
        method: "GET",
        headers: {
          Authorization: `Bearer ${this.settings.token}`
        }
      });
      if (!response) {
        throw new Error(`Failed to fetch books: ${response}`);
      }
      const data = JSON.parse(response);
      const books = (data.results || []).map((book) => {
        var _a;
        return {
          id: book.id,
          relPath: book.relPath,
          metadata: ((_a = book.media) == null ? void 0 : _a.metadata) || {}
        };
      }).sort((a, b) => a.relPath.localeCompare(b.relPath));
      const folder = this.app.vault.getAbstractFileByPath(`${this.settings.folder}`);
      if (!folder) {
        await this.app.vault.createFolder(`${this.settings.folder}`);
      }
      let abData = {};
      for (const book of books) {
        var metadata = book.metadata;
        abData["author"] = metadata.authorName;
        abData["authorNameLF"] = metadata.authorNameLF;
        abData["coverURL"] = `https://${this.settings.host}/audiobookshelf/api/items/${book.id}/cover`;
        abData["description"] = metadata.description;
        abData["jsonData"] = JSON.stringify(book, null, 2);
        abData["narrator"] = metadata.narrator;
        abData["publishedDate"] = metadata.publishedDate;
        abData["publishedYear"] = metadata.publishedYear;
        abData["publisher"] = metadata.publisher;
        abData["title"] = metadata.title;
        const sanitizedTitle = metadata.title.replace(/[\/:*?"<>|]/g, "");
        var filePath = "";
        if (book.metadata.seriesName != "") {
          filePath = `${this.settings.folder}/${abData["authorNameLF"]}/${book.metadata.seriesName.replace(/\s+#\d+$/, "").trim()}/${sanitizedTitle}.md`;
        } else {
          filePath = `${this.settings.folder}/${abData["authorNameLF"]}/${sanitizedTitle}.md`;
        }
        if (!this.app.vault.getAbstractFileByPath(filePath)) {
          await this.ensureFolderExists(filePath);
          await this.app.vault.create(filePath, this.getBookTemplate(abData));
          console.log(`Created: ${filePath}`);
        } else {
          console.log(`Skipped: ${filePath} (Already exists)`);
        }
      }
      new import_obsidian.Notice("Books fetched and notes created successfully!");
    } catch (error) {
      console.error("Error fetching books:", error, " from ", apiUrl);
      new import_obsidian.Notice("Failed to fetch books. Check the console for details.");
    }
  }
  async ensureFolderExists(filePath) {
    const folderPath = filePath.substring(0, filePath.lastIndexOf("/"));
    if (!folderPath)
      return;
    const folder = this.app.vault.getAbstractFileByPath(folderPath);
    if (!folder) {
      await this.app.vault.createFolder(folderPath);
      console.log(`Created folder: ${folderPath}`);
    }
  }
  getBookTemplate(abData) {
    return `${this.settings.template}`.replace(/{{author}}/g, abData["author"]).replace(/{{jsonData}}/g, abData["jsonData"]).replace(/{{title}}/g, abData["title"]).replace(/{{coverURL}}/g, abData["coverURL"]).replace(/{{narrator}}/g, abData["narrator"]).replace(/{{publishedYear}}/g, abData["publishedYear"]).replace(/{{publishedDate}}/g, abData["publishedDate"]).replace(/{{publisher}}/g, abData["publisher"]).replace(/{{description}}/g, abData["description"]);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var ABSPluginSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "ABS Plugin Settings" });
    new import_obsidian.Setting(containerEl).setName("API Host").setDesc("Enter the base URL of the API (without https://)").addText(
      (text) => text.setPlaceholder("example.abs.org").setValue(this.plugin.settings.host).onChange(async (value) => {
        this.plugin.settings.host = value.trim();
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Library").setDesc("Enter the library ID or name").addText(
      (text) => text.setPlaceholder("audiobooks").setValue(this.plugin.settings.library).onChange(async (value) => {
        this.plugin.settings.library = value.trim();
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("API Token").setDesc("Enter your API token").addText(
      (text) => text.setPlaceholder("your-token-here").setValue(this.plugin.settings.token).onChange(async (value) => {
        this.plugin.settings.token = value.trim();
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Folder").setDesc("Where to create pages.").addText(
      (text) => text.setPlaceholder("ABS").setValue(this.plugin.settings.folder).onChange(async (value) => {
        this.plugin.settings.folder = value.trim();
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Template").setDesc("Template for new pages.").addTextArea(
      (text) => text.setPlaceholder("<!--!>").setValue(this.plugin.settings.template).onChange(async (value) => {
        this.plugin.settings.template = value.trim();
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgIHJlcXVlc3QsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmludGVyZmFjZSBBQlNQbHVnaW5TZXR0aW5ncyB7XG4gIGhvc3Q6IHN0cmluZztcbiAgbGlicmFyeTogc3RyaW5nO1xuICB0b2tlbjogc3RyaW5nO1xuICBmb2xkZXI6IHN0cmluZztcbiAgdGVtcGxhdGU6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQUJTUGx1Z2luU2V0dGluZ3MgPSB7XG4gIGhvc3Q6IFwiXCIsXG4gIGxpYnJhcnk6IFwiXCIsXG4gIHRva2VuOiBcIlwiLFxuICBmb2xkZXI6IFwiXCIsXG4gIHRlbXBsYXRlOiBcIlwiLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQUJTUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgc2V0dGluZ3M6IEFCU1BsdWdpblNldHRpbmdzO1xuXG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcbiAgICAgIHt9LCBcbiAgICAgIERFRkFVTFRfU0VUVElOR1MsIFxuICAgICAgYXdhaXQgdGhpcy5sb2FkRGF0YSgpXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBBQlNQbHVnaW5TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICBjb25zdCByaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oXCJhdWRpby1maWxlXCIsIFwiQUJTXCIsICgpID0+IHtcbiAgICAgIG5ldyBOb3RpY2UoXCJGZXRjaGluZyBhdWRpb2Jvb2tzLi4uXCIpO1xuICAgICAgdGhpcy5mZXRjaEFuZENyZWF0ZU5vdGVzKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6IFwiZmV0Y2gtYm9va3NcIixcbiAgICAgIG5hbWU6IFwiRmV0Y2ggYm9va3MgYW5kIGNyZWF0ZSBub3Rlc1wiLFxuICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5mZXRjaEFuZENyZWF0ZU5vdGVzKCk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZmV0Y2hBbmRDcmVhdGVOb3RlcygpIHtcbiAgICBpZiAoIXRoaXMuc2V0dGluZ3MuaG9zdCB8fCAhdGhpcy5zZXR0aW5ncy5saWJyYXJ5IHx8ICF0aGlzLnNldHRpbmdzLnRva2VuKSB7XG4gICAgICBuZXcgTm90aWNlKFwiUGxlYXNlIGNvbmZpZ3VyZSBBUEkgc2V0dGluZ3MgaW4gdGhlIEFCUyBQbHVnaW4gc2V0dGluZ3MuXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuc2V0dGluZ3MuZm9sZGVyKSB7XG4gICAgICBuZXcgTm90aWNlKFwiUGxlYXNlIGNvbmZpZ3VyZSBkZXN0aW5hdGlvbiBmb2xkZXIgaW4gdGhlIEFCUyBQbHVnaW4gc2V0dGluZ3MuXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGFwaVVybCA9IGBodHRwczovLyR7dGhpcy5zZXR0aW5ncy5ob3N0fS9hcGkvbGlicmFyaWVzLyR7dGhpcy5zZXR0aW5ncy5saWJyYXJ5fS9pdGVtcz9zb3J0PW1lZGlhLm1ldGFkYXRhLnRpdGxlYDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGFwaVVybCxcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuc2V0dGluZ3MudG9rZW59YCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICBcblxuICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBib29rczogJHtyZXNwb25zZX1gKTtcbiAgICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICBcbiAgICBjb25zdCBib29rcyA9IChkYXRhLnJlc3VsdHMgfHwgW10pXG4gICAgICAubWFwKChib29rOiBhbnkpID0+ICh7XG4gICAgICAgIGlkOiBib29rLmlkLFxuICAgICAgICByZWxQYXRoOiBib29rLnJlbFBhdGgsXG4gICAgICAgIG1ldGFkYXRhOiBib29rLm1lZGlhPy5tZXRhZGF0YSB8fCB7fSwgXG4gICAgICB9KSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhLnJlbFBhdGgubG9jYWxlQ29tcGFyZShiLnJlbFBhdGgpKTsgXG5cbiAgICBjb25zdCBmb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7dGhpcy5zZXR0aW5ncy5mb2xkZXJ9YCk7XG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihgJHt0aGlzLnNldHRpbmdzLmZvbGRlcn1gKTtcbiAgICB9XG5cbiAgICBsZXQgYWJEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgICBmb3IgKGNvbnN0IGJvb2sgb2YgYm9va3MpIHtcbiAgICAgIHZhciBtZXRhZGF0YSA9IGJvb2subWV0YWRhdGE7XG4gICAgICBhYkRhdGFbXCJhdXRob3JcIl0gPSBtZXRhZGF0YS5hdXRob3JOYW1lO1xuICAgICAgYWJEYXRhW1wiYXV0aG9yTmFtZUxGXCJdID0gbWV0YWRhdGEuYXV0aG9yTmFtZUxGO1xuICAgICAgYWJEYXRhW1wiY292ZXJVUkxcIl0gPSBgaHR0cHM6Ly8ke3RoaXMuc2V0dGluZ3MuaG9zdH0vYXVkaW9ib29rc2hlbGYvYXBpL2l0ZW1zLyR7Ym9vay5pZH0vY292ZXJgXG4gICAgICBhYkRhdGFbXCJkZXNjcmlwdGlvblwiXSA9IG1ldGFkYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgYWJEYXRhW1wianNvbkRhdGFcIl0gPSBKU09OLnN0cmluZ2lmeShib29rLCBudWxsLCAyKVxuICAgICAgYWJEYXRhW1wibmFycmF0b3JcIl0gPSBtZXRhZGF0YS5uYXJyYXRvcjtcbiAgICAgIGFiRGF0YVtcInB1Ymxpc2hlZERhdGVcIl0gPSBtZXRhZGF0YS5wdWJsaXNoZWREYXRlO1xuICAgICAgYWJEYXRhW1wicHVibGlzaGVkWWVhclwiXSA9IG1ldGFkYXRhLnB1Ymxpc2hlZFllYXI7XG4gICAgICBhYkRhdGFbXCJwdWJsaXNoZXJcIl0gPSBtZXRhZGF0YS5wdWJsaXNoZXI7XG4gICAgICBhYkRhdGFbXCJ0aXRsZVwiXSA9IG1ldGFkYXRhLnRpdGxlO1xuXG4gICAgICBjb25zdCBzYW5pdGl6ZWRUaXRsZSA9IG1ldGFkYXRhLnRpdGxlLnJlcGxhY2UoL1tcXC86Kj9cIjw+fF0vZywgXCJcIik7XG4gICAgICB2YXIgZmlsZVBhdGggPSBcIlwiXG5cbiAgICAgIGlmIChib29rLm1ldGFkYXRhLnNlcmllc05hbWUgIT0gXCJcIikge1xuICAgICAgICBmaWxlUGF0aCA9IGAke3RoaXMuc2V0dGluZ3MuZm9sZGVyfS8ke2FiRGF0YVtcImF1dGhvck5hbWVMRlwiXX0vJHtib29rLm1ldGFkYXRhLnNlcmllc05hbWUucmVwbGFjZSgvXFxzKyNcXGQrJC8sIFwiXCIpLnRyaW0oKX0vJHtzYW5pdGl6ZWRUaXRsZX0ubWRgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmlsZVBhdGggPSBgJHt0aGlzLnNldHRpbmdzLmZvbGRlcn0vJHthYkRhdGFbXCJhdXRob3JOYW1lTEZcIl19LyR7c2FuaXRpemVkVGl0bGV9Lm1kYDtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZW5zdXJlRm9sZGVyRXhpc3RzKGZpbGVQYXRoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCB0aGlzLmdldEJvb2tUZW1wbGF0ZShhYkRhdGEpKVxuICAgICAgICAvLyBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIEpTT04uc3RyaW5naWZ5KGJvb2ssIG51bGwsIDIpKTtcbiAgICAgICAgY29uc29sZS5sb2coYENyZWF0ZWQ6ICR7ZmlsZVBhdGh9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhgU2tpcHBlZDogJHtmaWxlUGF0aH0gKEFscmVhZHkgZXhpc3RzKWApO1xuICAgICAgfVxuICAgIH1cbiAgICAgIG5ldyBOb3RpY2UoXCJCb29rcyBmZXRjaGVkIGFuZCBub3RlcyBjcmVhdGVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBib29rczpcIiwgZXJyb3IsIFwiIGZyb20gXCIsIGFwaVVybCk7XG4gICAgICBuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGZldGNoIGJvb2tzLiBDaGVjayB0aGUgY29uc29sZSBmb3IgZGV0YWlscy5cIik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZW5zdXJlRm9sZGVyRXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgICBjb25zdCBmb2xkZXJQYXRoID0gZmlsZVBhdGguc3Vic3RyaW5nKDAsIGZpbGVQYXRoLmxhc3RJbmRleE9mKFwiL1wiKSk7XG4gIFxuICAgIGlmICghZm9sZGVyUGF0aCkgcmV0dXJuO1xuICBcbiAgICBjb25zdCBmb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCk7XG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgIGNvbnNvbGUubG9nKGBDcmVhdGVkIGZvbGRlcjogJHtmb2xkZXJQYXRofWApO1xuICAgIH1cbiAgfVxuXG4gIGdldEJvb2tUZW1wbGF0ZShhYkRhdGEpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5zZXR0aW5ncy50ZW1wbGF0ZX1gXG4gICAgICAucmVwbGFjZSgve3thdXRob3J9fS9nLCBhYkRhdGFbXCJhdXRob3JcIl0pXG4gICAgICAucmVwbGFjZSgve3tqc29uRGF0YX19L2csIGFiRGF0YVtcImpzb25EYXRhXCJdKVxuICAgICAgLnJlcGxhY2UoL3t7dGl0bGV9fS9nLCBhYkRhdGFbXCJ0aXRsZVwiXSlcbiAgICAgIC5yZXBsYWNlKC97e2NvdmVyVVJMfX0vZywgYWJEYXRhW1wiY292ZXJVUkxcIl0pXG4gICAgICAucmVwbGFjZSgve3tuYXJyYXRvcn19L2csIGFiRGF0YVtcIm5hcnJhdG9yXCJdKVxuICAgICAgLnJlcGxhY2UoL3t7cHVibGlzaGVkWWVhcn19L2csIGFiRGF0YVtcInB1Ymxpc2hlZFllYXJcIl0pXG4gICAgICAucmVwbGFjZSgve3twdWJsaXNoZWREYXRlfX0vZywgYWJEYXRhW1wicHVibGlzaGVkRGF0ZVwiXSlcbiAgICAgIC5yZXBsYWNlKC97e3B1Ymxpc2hlcn19L2csIGFiRGF0YVtcInB1Ymxpc2hlclwiXSlcbiAgICAgIC5yZXBsYWNlKC97e2Rlc2NyaXB0aW9ufX0vZywgYWJEYXRhW1wiZGVzY3JpcHRpb25cIl0pO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cbn1cblxuY2xhc3MgQUJTUGx1Z2luU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IEFCU1BsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHAsIHBsdWdpbikge1xuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGRpc3BsYXkoKSB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiQUJTIFBsdWdpbiBTZXR0aW5nc1wiIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkFQSSBIb3N0XCIpXG4gICAgICAuc2V0RGVzYyhcIkVudGVyIHRoZSBiYXNlIFVSTCBvZiB0aGUgQVBJICh3aXRob3V0IGh0dHBzOi8vKVwiKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJleGFtcGxlLmFicy5vcmdcIilcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaG9zdClcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ob3N0ID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfSlcbiAgICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiTGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJFbnRlciB0aGUgbGlicmFyeSBJRCBvciBuYW1lXCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcImF1ZGlvYm9va3NcIilcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlicmFyeSlcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWJyYXJ5ID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfSlcbiAgICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiQVBJIFRva2VuXCIpXG4gICAgICAuc2V0RGVzYyhcIkVudGVyIHlvdXIgQVBJIHRva2VuXCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcInlvdXItdG9rZW4taGVyZVwiKVxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbilcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbiA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkZvbGRlclwiKVxuICAgICAgLnNldERlc2MoXCJXaGVyZSB0byBjcmVhdGUgcGFnZXMuXCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkFCU1wiKVxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXIpXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9sZGVyID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfSlcbiAgICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiVGVtcGxhdGVcIilcbiAgICAgIC5zZXREZXNjKFwiVGVtcGxhdGUgZm9yIG5ldyBwYWdlcy5cIilcbiAgICAgIC5hZGRUZXh0QXJlYSgodGV4dCkgPT5cbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIjwhLS0hPlwiKVxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZSlcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH0pXG4gICAgICApO1xuICB9XG59XG5cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBb0U7QUFVcEUsSUFBTSxtQkFBc0M7QUFBQSxFQUMxQyxNQUFNO0FBQUEsRUFDTixTQUFTO0FBQUEsRUFDVCxPQUFPO0FBQUEsRUFDUCxRQUFRO0FBQUEsRUFDUixVQUFVO0FBQ1o7QUFFQSxJQUFxQixZQUFyQixjQUF1Qyx1QkFBTztBQUFBLEVBRzVDLE1BQU0sZUFBZTtBQUNuQixTQUFLLFdBQVcsT0FBTztBQUFBLE1BQ3JCLENBQUM7QUFBQSxNQUNEO0FBQUEsTUFDQSxNQUFNLEtBQUssU0FBUztBQUFBLElBQ3RCO0FBQUEsRUFDRjtBQUFBLEVBRUEsTUFBTSxTQUFTO0FBQ2IsVUFBTSxLQUFLLGFBQWE7QUFFeEIsU0FBSyxjQUFjLElBQUksb0JBQW9CLEtBQUssS0FBSyxJQUFJLENBQUM7QUFFMUQsVUFBTSxlQUFlLEtBQUssY0FBYyxjQUFjLE9BQU8s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
